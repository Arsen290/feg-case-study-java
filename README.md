# FEG test task

## Starting
<p>In this block you can see how start the application.</p>
<p>To start application you need to compile files by Maven package. You will need download <a href="https://www.oracle.com/java/technologies/javase-downloads.html">Java Development Kit</a> and <a href="https://maven.apache.org/download.cgi">Maven</a>. Or if you have JDK and Maven, you need print some commands to compile and run the app.</p>

### Compiling and running app
Downloading and compiling:
```
git clone https://github.com/Arsen290/feg-case-study-java.git
cd feg-case-study-java
mvn compile
```

Running app:
```
mvn exec:java
```

OR
```
java -cp target/classes feg.assigment.app
```

### Run the Packaged app
Packing app into jar file:
```
mvn package
```

Run the packaged app:
```
java -jar target/FEG_CaseStudy_Java 1.0-SNAPSHOT
```

### Tests
Command line to write 
```
java -cp .:junit-4.13.2.jar:hamcrest-core-1.3.jar org.junit.runner.JUnitCore feg.assigment.AppTest feg.assigment.CustomerTest
```
<p>Replace junit-4.13.2.jar and hamcrest-core-1.3.jar with the actual JAR file names and versions for JUnit 4 and Hamcrest.</p>

## About application
<p>This is single java command-line application that reads a CSV file that contains customer information. Application outputting a report showing the total revenue generated by each customer. Also application using Java 17 and Maven. </p>

## Formats of input and output CSV files

CSV format(file.csv):
```
Name, Revenue
John Smith, 20.0
Jane Doe, 220.0
Bob Johnson, 640.0
```

Customer report format:
```
John Smith: $20.0
Jane Doe: $220.0
Bob Johnson: $640.0
```

## Classes and theirs methods

public class Customer
```
@CsvBindByPosition(position = 0)
private String name;

@CsvBindByPosition(position = 1)
private double revenue;

public Customer() {
}

public Customer(String name, double revenue) {
    this.name = name;
    this.revenue = revenue;
}

public String getName() {
    return name;
}

public double getRevenue() {
    return revenue;
}

public void setName(String name) {
    this.name = name;
}

public void setRevenue(double revenue) {
    this.revenue = revenue;
}

@Override
public String toString() {
    return name + ": $" + revenue;
}
```

public class App
```
public static void main(String[] args) throws IOException, CsvException {
    Scanner sc = new Scanner(System.in);
    System.out.println("Write the name of the file in the customers folder:");
    String file = sc.nextLine();

    String filePath = "./src/customers/" + file + (".csv");
    try (FileWriter writer = new FileWriter("output.csv");
        CSVReader reader = new CSVReaderBuilder(new FileReader(filePath)).withSkipLines(1).build()) {
        String[] lineInArray;

        while ((lineInArray = reader.readNext()) != null) {
            String name = lineInArray[0];
            double revenue = Double.parseDouble(lineInArray[1].trim());
            String customerReport = name + ":" + " $" + revenue + "\n";
            writer.write(customerReport);
        }
    }

    parseCSV(filePath);
    calculateRevenue(parseCSV(filePath));
    printReport(calculateRevenue(parseCSV(filePath)));
}

private static List<Customer> parseCSV(String filename) throws IOException, CsvException {
    List<Customer> listCustomers = new ArrayList<>();
    listCustomers = new CsvToBeanBuilder(new FileReader(filename))
            .withSkipLines(1)
            .withType(Customer.class)
            .build()
            .parse();
    return listCustomers;
}

private static Map<String, Double> calculateRevenue(List<Customer> customers) {
    Map<String, Double> mapCustomers = new HashMap<>();
    for (Customer customer : customers) {
        mapCustomers.put(customer.getName(), customer.getRevenue());
    }
    return mapCustomers;
}

private static void printReport(Map<String, Double> revenueMap) {
    revenueMap.forEach((name, revenue) -> System.out.println(name + ":" + " $" + revenue));
}

```